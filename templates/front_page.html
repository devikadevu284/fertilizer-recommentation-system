<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fertilizer Recommendation</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- Botpress Chat Bubble Script -->
    <script src="https://cdn.botpress.cloud/webchat/v2.3/inject.js"></script>
    <script src="https://files.bpcontent.cloud/2024/12/04/05/20241204055923-YIY3FY15.js"></script>

    <!-- Style for embedded chatbot -->
    <style>
      #webchat .bpWebchat {
        position: unset;
        width: 100%;
        height: 100%;
        max-height: 100%;
        max-width: 100%;
      }

      #webchat .bpFab {
        display: none;
      }

      /* Ensure chatbot visibility */
      #webchat {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
      }
    </style>
</head>

<body>
    <div class="container">
        <h2>Fertilizer Recommendation System</h2>

        <form action="/predict" method="POST">
            <label>Temperature (Â°C):</label>
            <input type="number" name="temperature" required>

            <label>Humidity (%):</label>
            <input type="number" name="humidity" required>

            <label>Moisture (%):</label>
            <input type="number" name="moisture" required>

            <label>Soil Type:</label>
            <select name="soil">
                <option value="sandy">Sandy</option>
                <option value="clay">Clay</option>
                <option value="loamy">Loamy</option>
            </select>

            <label>Crop Type:</label>
            <select name="crop">
                <option value="wheat">Wheat</option>
                <option value="rice">Rice</option>
                <option value="maize">Maize</option>
                <option value="sugarcane">Sugarcane</option>
            </select>

            <label>Nitrogen (N):</label>
            <input type="number" name="nitrogen" required>

            <label>Potassium (K):</label>
            <input type="number" name="potassium" required>

            <label>Phosphorous (P):</label>
            <input type="number" name="phosphorous" required>

            <button type="submit">Get Recommendation</button>
        </form>

        {% if prediction_text %}
            <div class="result">{{ prediction_text }}</div>
        {% endif %}
    </div>

    <!-- Embedded Chatbot Section -->
    <div id="webchat" style="width: 500px; height: 500px; margin: auto; padding-top: 20px;"></div>

    <!-- Chatbot Initialization Script -->
    <script>
      window.botpress.on("webchat:ready", () => {
        window.botpress.open();
      });

      window.botpress.init({
        botId: "4884fa89-2034-4a32-b60b-0fa009b88c12",
        clientId: "918318b9-2bcf-40d9-ab0c-3204748478d8",
        configuration: {
          website: {},
          email: {},
          phone: {},
          termsOfService: {},
          privacyPolicy: {},
          color: "#55f53b",
          variant: "solid",
          themeMode: "light",
          fontFamily: "inter",
          radius: 4,
          additionalStylesheetUrl: "https://files.bpcontent.cloud/2024/12/04/10/20241204104119-UC7L4YR6.css"
        },
        selector: "#webchat"
      });
    </script>

    <!-- Minimal Botpress Test Setup -->
    <h1>Testing Botpress Chatbot</h1>
    <script>
      window.botpress.init({
        botId: "4884fa89-2034-4a32-b60b-0fa009b88c12",
        clientId: "918318b9-2bcf-40d9-ab0c-3204748478d8",
        "theme": "light"
      });
    </script>
</body>
</html>

